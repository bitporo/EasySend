import{_ as e,o,c as s,w as t,r as n,n as l,a as i,i as a,b as c,d,e as u,f as r,g as f,F as h,h as p,I as m,j as _,s as y,k as g,l as b,u as w,m as x,p as S,q as k,t as v,v as C,x as I,y as $,z as F}from"./index-CHbnkwyV.js";const B=[{font_class:"arrow-down",unicode:""},{font_class:"arrow-left",unicode:""},{font_class:"arrow-right",unicode:""},{font_class:"arrow-up",unicode:""},{font_class:"auth",unicode:""},{font_class:"auth-filled",unicode:""},{font_class:"back",unicode:""},{font_class:"bars",unicode:""},{font_class:"calendar",unicode:""},{font_class:"calendar-filled",unicode:""},{font_class:"camera",unicode:""},{font_class:"camera-filled",unicode:""},{font_class:"cart",unicode:""},{font_class:"cart-filled",unicode:""},{font_class:"chat",unicode:""},{font_class:"chat-filled",unicode:""},{font_class:"chatboxes",unicode:""},{font_class:"chatboxes-filled",unicode:""},{font_class:"chatbubble",unicode:""},{font_class:"chatbubble-filled",unicode:""},{font_class:"checkbox",unicode:""},{font_class:"checkbox-filled",unicode:""},{font_class:"checkmarkempty",unicode:""},{font_class:"circle",unicode:""},{font_class:"circle-filled",unicode:""},{font_class:"clear",unicode:""},{font_class:"close",unicode:""},{font_class:"closeempty",unicode:""},{font_class:"cloud-download",unicode:""},{font_class:"cloud-download-filled",unicode:""},{font_class:"cloud-upload",unicode:""},{font_class:"cloud-upload-filled",unicode:""},{font_class:"color",unicode:""},{font_class:"color-filled",unicode:""},{font_class:"compose",unicode:""},{font_class:"contact",unicode:""},{font_class:"contact-filled",unicode:""},{font_class:"down",unicode:""},{font_class:"bottom",unicode:""},{font_class:"download",unicode:""},{font_class:"download-filled",unicode:""},{font_class:"email",unicode:""},{font_class:"email-filled",unicode:""},{font_class:"eye",unicode:""},{font_class:"eye-filled",unicode:""},{font_class:"eye-slash",unicode:""},{font_class:"eye-slash-filled",unicode:""},{font_class:"fire",unicode:""},{font_class:"fire-filled",unicode:""},{font_class:"flag",unicode:""},{font_class:"flag-filled",unicode:""},{font_class:"folder-add",unicode:""},{font_class:"folder-add-filled",unicode:""},{font_class:"font",unicode:""},{font_class:"forward",unicode:""},{font_class:"gear",unicode:""},{font_class:"gear-filled",unicode:""},{font_class:"gift",unicode:""},{font_class:"gift-filled",unicode:""},{font_class:"hand-down",unicode:""},{font_class:"hand-down-filled",unicode:""},{font_class:"hand-up",unicode:""},{font_class:"hand-up-filled",unicode:""},{font_class:"headphones",unicode:""},{font_class:"heart",unicode:""},{font_class:"heart-filled",unicode:""},{font_class:"help",unicode:""},{font_class:"help-filled",unicode:""},{font_class:"home",unicode:""},{font_class:"home-filled",unicode:""},{font_class:"image",unicode:""},{font_class:"image-filled",unicode:""},{font_class:"images",unicode:""},{font_class:"images-filled",unicode:""},{font_class:"info",unicode:""},{font_class:"info-filled",unicode:""},{font_class:"left",unicode:""},{font_class:"link",unicode:""},{font_class:"list",unicode:""},{font_class:"location",unicode:""},{font_class:"location-filled",unicode:""},{font_class:"locked",unicode:""},{font_class:"locked-filled",unicode:""},{font_class:"loop",unicode:""},{font_class:"mail-open",unicode:""},{font_class:"mail-open-filled",unicode:""},{font_class:"map",unicode:""},{font_class:"map-filled",unicode:""},{font_class:"map-pin",unicode:""},{font_class:"map-pin-ellipse",unicode:""},{font_class:"medal",unicode:""},{font_class:"medal-filled",unicode:""},{font_class:"mic",unicode:""},{font_class:"mic-filled",unicode:""},{font_class:"micoff",unicode:""},{font_class:"micoff-filled",unicode:""},{font_class:"minus",unicode:""},{font_class:"minus-filled",unicode:""},{font_class:"more",unicode:""},{font_class:"more-filled",unicode:""},{font_class:"navigate",unicode:""},{font_class:"navigate-filled",unicode:""},{font_class:"notification",unicode:""},{font_class:"notification-filled",unicode:""},{font_class:"paperclip",unicode:""},{font_class:"paperplane",unicode:""},{font_class:"paperplane-filled",unicode:""},{font_class:"person",unicode:""},{font_class:"person-filled",unicode:""},{font_class:"personadd",unicode:""},{font_class:"personadd-filled",unicode:""},{font_class:"personadd-filled-copy",unicode:""},{font_class:"phone",unicode:""},{font_class:"phone-filled",unicode:""},{font_class:"plus",unicode:""},{font_class:"plus-filled",unicode:""},{font_class:"plusempty",unicode:""},{font_class:"pulldown",unicode:""},{font_class:"pyq",unicode:""},{font_class:"qq",unicode:""},{font_class:"redo",unicode:""},{font_class:"redo-filled",unicode:""},{font_class:"refresh",unicode:""},{font_class:"refresh-filled",unicode:""},{font_class:"refreshempty",unicode:""},{font_class:"reload",unicode:""},{font_class:"right",unicode:""},{font_class:"scan",unicode:""},{font_class:"search",unicode:""},{font_class:"settings",unicode:""},{font_class:"settings-filled",unicode:""},{font_class:"shop",unicode:""},{font_class:"shop-filled",unicode:""},{font_class:"smallcircle",unicode:""},{font_class:"smallcircle-filled",unicode:""},{font_class:"sound",unicode:""},{font_class:"sound-filled",unicode:""},{font_class:"spinner-cycle",unicode:""},{font_class:"staff",unicode:""},{font_class:"staff-filled",unicode:""},{font_class:"star",unicode:""},{font_class:"star-filled",unicode:""},{font_class:"starhalf",unicode:""},{font_class:"trash",unicode:""},{font_class:"trash-filled",unicode:""},{font_class:"tune",unicode:""},{font_class:"tune-filled",unicode:""},{font_class:"undo",unicode:""},{font_class:"undo-filled",unicode:""},{font_class:"up",unicode:""},{font_class:"top",unicode:""},{font_class:"upload",unicode:""},{font_class:"upload-filled",unicode:""},{font_class:"videocam",unicode:""},{font_class:"videocam-filled",unicode:""},{font_class:"vip",unicode:""},{font_class:"vip-filled",unicode:""},{font_class:"wallet",unicode:""},{font_class:"wallet-filled",unicode:""},{font_class:"weibo",unicode:""},{font_class:"weixin",unicode:""}];const V=e({name:"UniIcons",emits:["click"],props:{type:{type:String,default:""},color:{type:String,default:"#333333"},size:{type:[Number,String],default:16},customPrefix:{type:String,default:""},fontFamily:{type:String,default:""}},data:()=>({icons:B}),computed:{unicode(){let e=this.icons.find((e=>e.font_class===this.type));return e?e.unicode:""},iconSize(){return"number"==typeof(e=this.size)||/^[0-9]*$/g.test(e)?e+"px":e;var e},styleObj(){return""!==this.fontFamily?`color: ${this.color}; font-size: ${this.iconSize}; font-family: ${this.fontFamily};`:`color: ${this.color}; font-size: ${this.iconSize};`}},methods:{_onClick(){this.$emit("click")}}},[["render",function(e,c,d,u,r,f){const h=a;return o(),s(h,{style:l(f.styleObj),class:i(["uni-icons",["uniui-"+d.type,d.customPrefix,d.customPrefix?d.type:""]]),onClick:f._onClick},{default:t((()=>[n(e.$slots,"default",{},void 0,!0)])),_:3},8,["style","class","onClick"])}],["__scopeId","data-v-5610c8db"]]);function z(e){let o="";for(let s in e){o+=`${s}:${e[s]};`}return o}const P=e({name:"uni-easyinput",emits:["click","iconClick","update:modelValue","input","focus","blur","confirm","clear","eyes","change","keyboardheightchange"],model:{prop:"modelValue",event:"update:modelValue"},options:{virtualHost:!0},inject:{form:{from:"uniForm",default:null},formItem:{from:"uniFormItem",default:null}},props:{name:String,value:[Number,String],modelValue:[Number,String],type:{type:String,default:"text"},clearable:{type:Boolean,default:!0},autoHeight:{type:Boolean,default:!1},placeholder:{type:String,default:" "},placeholderStyle:String,focus:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},maxlength:{type:[Number,String],default:140},confirmType:{type:String,default:"done"},clearSize:{type:[Number,String],default:24},inputBorder:{type:Boolean,default:!0},prefixIcon:{type:String,default:""},suffixIcon:{type:String,default:""},trim:{type:[Boolean,String],default:!1},cursorSpacing:{type:Number,default:0},passwordIcon:{type:Boolean,default:!0},adjustPosition:{type:Boolean,default:!0},primaryColor:{type:String,default:"#2979ff"},styles:{type:Object,default:()=>({color:"#333",backgroundColor:"#fff",disableColor:"#F7F6F6",borderColor:"#e5e5e5"})},errorMessage:{type:[String,Boolean],default:""}},data:()=>({focused:!1,val:"",showMsg:"",border:!1,isFirstBorder:!1,showClearIcon:!1,showPassword:!1,focusShow:!1,localMsg:"",isEnter:!1}),computed:{isVal(){const e=this.val;return!(!e&&0!==e)},msg(){return this.localMsg||this.errorMessage},inputMaxlength(){return Number(this.maxlength)},boxStyle(){return`color:${this.inputBorder&&this.msg?"#e43d33":this.styles.color};`},inputContentClass(){return function(e){let o="";for(let s in e)e[s]&&(o+=`${s} `);return o}({"is-input-border":this.inputBorder,"is-input-error-border":this.inputBorder&&this.msg,"is-textarea":"textarea"===this.type,"is-disabled":this.disabled,"is-focused":this.focusShow})},inputContentStyle(){const e=this.focusShow?this.primaryColor:this.styles.borderColor;return z({"border-color":(this.inputBorder&&this.msg?"#dd524d":e)||"#e5e5e5","background-color":this.disabled?this.styles.disableColor:this.styles.backgroundColor})},inputStyle(){return z({"padding-right":"password"===this.type||this.clearable||this.prefixIcon?"":"10px","padding-left":this.prefixIcon?"":"10px"})}},watch:{value(e){this.val=e},modelValue(e){this.val=e},focus(e){this.$nextTick((()=>{this.focused=this.focus,this.focusShow=this.focus}))}},created(){this.init(),this.form&&this.formItem&&this.$watch("formItem.errMsg",(e=>{this.localMsg=e}))},mounted(){this.$nextTick((()=>{this.focused=this.focus,this.focusShow=this.focus}))},methods:{init(){this.value||0===this.value?this.val=this.value:this.modelValue||0===this.modelValue||""===this.modelValue?this.val=this.modelValue:this.val=null},onClickIcon(e){this.$emit("iconClick",e)},onEyes(){this.showPassword=!this.showPassword,this.$emit("eyes",this.showPassword)},onInput(e){let o=e.detail.value;this.trim&&("boolean"==typeof this.trim&&this.trim&&(o=this.trimStr(o)),"string"==typeof this.trim&&(o=this.trimStr(o,this.trim))),this.errMsg&&(this.errMsg=""),this.val=o,this.$emit("input",o),this.$emit("update:modelValue",o)},onFocus(){this.$nextTick((()=>{this.focused=!0})),this.$emit("focus",null)},_Focus(e){this.focusShow=!0,this.$emit("focus",e)},onBlur(){this.focused=!1,this.$emit("blur",null)},_Blur(e){if(e.detail.value,this.focusShow=!1,this.$emit("blur",e),!1===this.isEnter&&this.$emit("change",this.val),this.form&&this.formItem){const{validateTrigger:e}=this.form;"blur"===e&&this.formItem.onFieldChange()}},onConfirm(e){this.$emit("confirm",this.val),this.isEnter=!0,this.$emit("change",this.val),this.$nextTick((()=>{this.isEnter=!1}))},onClear(e){this.val="",this.$emit("input",""),this.$emit("update:modelValue",""),this.$emit("clear")},onkeyboardheightchange(e){this.$emit("keyboardheightchange",e)},trimStr:(e,o="both")=>"both"===o?e.trim():"left"===o?e.trimLeft():"right"===o?e.trimRight():"start"===o?e.trimStart():"end"===o?e.trimEnd():"all"===o?e.replace(/\s+/g,""):e}},[["render",function(e,a,y,g,b,w){const x=c(d("uni-icons"),V),S=p,k=m,v=_;return o(),s(v,{class:i(["uni-easyinput",{"uni-easyinput-error":w.msg}]),style:l(w.boxStyle)},{default:t((()=>[u(v,{class:i(["uni-easyinput__content",w.inputContentClass]),style:l(w.inputContentStyle)},{default:t((()=>[y.prefixIcon?(o(),s(x,{key:0,class:"content-clear-icon",type:y.prefixIcon,color:"#c0c4cc",onClick:a[0]||(a[0]=e=>w.onClickIcon("prefix")),size:"22"},null,8,["type"])):r("",!0),n(e.$slots,"left",{},void 0,!0),"textarea"===y.type?(o(),s(S,{key:1,class:i(["uni-easyinput__content-textarea",{"input-padding":y.inputBorder}]),name:y.name,value:b.val,placeholder:y.placeholder,placeholderStyle:y.placeholderStyle,disabled:y.disabled,"placeholder-class":"uni-easyinput__placeholder-class",maxlength:w.inputMaxlength,focus:b.focused,autoHeight:y.autoHeight,"cursor-spacing":y.cursorSpacing,"adjust-position":y.adjustPosition,onInput:w.onInput,onBlur:w._Blur,onFocus:w._Focus,onConfirm:w.onConfirm,onKeyboardheightchange:w.onkeyboardheightchange},null,8,["class","name","value","placeholder","placeholderStyle","disabled","maxlength","focus","autoHeight","cursor-spacing","adjust-position","onInput","onBlur","onFocus","onConfirm","onKeyboardheightchange"])):(o(),s(k,{key:2,type:"password"===y.type?"text":y.type,class:"uni-easyinput__content-input",style:l(w.inputStyle),name:y.name,value:b.val,password:!b.showPassword&&"password"===y.type,placeholder:y.placeholder,placeholderStyle:y.placeholderStyle,"placeholder-class":"uni-easyinput__placeholder-class",disabled:y.disabled,maxlength:w.inputMaxlength,focus:b.focused,confirmType:y.confirmType,"cursor-spacing":y.cursorSpacing,"adjust-position":y.adjustPosition,onFocus:w._Focus,onBlur:w._Blur,onInput:w.onInput,onConfirm:w.onConfirm,onKeyboardheightchange:w.onkeyboardheightchange},null,8,["type","style","name","value","password","placeholder","placeholderStyle","disabled","maxlength","focus","confirmType","cursor-spacing","adjust-position","onFocus","onBlur","onInput","onConfirm","onKeyboardheightchange"])),"password"===y.type&&y.passwordIcon?(o(),f(h,{key:3},[w.isVal?(o(),s(x,{key:0,class:i(["content-clear-icon",{"is-textarea-icon":"textarea"===y.type}]),type:b.showPassword?"eye-slash-filled":"eye-filled",size:22,color:b.focusShow?y.primaryColor:"#c0c4cc",onClick:w.onEyes},null,8,["class","type","color","onClick"])):r("",!0)],64)):r("",!0),y.suffixIcon?(o(),f(h,{key:4},[y.suffixIcon?(o(),s(x,{key:0,class:"content-clear-icon",type:y.suffixIcon,color:"#c0c4cc",onClick:a[1]||(a[1]=e=>w.onClickIcon("suffix")),size:"22"},null,8,["type"])):r("",!0)],64)):(o(),f(h,{key:5},[y.clearable&&w.isVal&&!y.disabled&&"textarea"!==y.type?(o(),s(x,{key:0,class:i(["content-clear-icon",{"is-textarea-icon":"textarea"===y.type}]),type:"clear",size:y.clearSize,color:w.msg?"#dd524d":b.focusShow?y.primaryColor:"#c0c4cc",onClick:w.onClear},null,8,["class","size","color","onClick"])):r("",!0)],64)),n(e.$slots,"right",{},void 0,!0)])),_:3},8,["class","style"])])),_:3},8,["class","style"])}],["__scopeId","data-v-5763a810"]]);const M=e({data:()=>({textMode:!0,contentValue:"",loading:!1,messageList:[],scrollElement:null,downLoadProcess:0,onItemId:"",baseUrl:`http://${window.location.hostname}:7071/api`}),inject:["baseUrl"],onLoad(){},mounted(){this.scrollElement=this.$refs.scrollView,this.getMessageList()},methods:{handleSend(e){if(!this.contentValue&&!e)return void y({icon:"error",title:"内容不能为空！"});this.loading=!0;const o={type:e?"file":"text",dateTime:(new Date).toLocaleString(),content:this.contentValue,fileData:e};g({url:this.baseUrl+"/message/addMessageData",method:"POST",data:{data:o}}).then((e=>{this.loading=!1,this.contentValue="",this.getMessageList()}))},handleFileSend(){b().then((e=>{const o=this;w({url:this.baseUrl+"/message/uploadFile",filePath:e.tempFilePaths[0],name:"file",success:e=>{const s=JSON.parse(e.data);o.handleSend(s.data)}}).onProgressUpdate((e=>{console.log("上传进度"+e.progress),console.log("已经上传的数据长度"+e.totalBytesSent),console.log("预期需要上传的数据总长度"+e.totalBytesExpectedToSend)}))}))},getMessageList(){g({url:this.baseUrl+"/message/getMessageList",method:"GET"}).then((e=>{this.messageList=e.data,x((()=>{this.scrollElement.scrollTop=this.scrollElement.scrollHeight}))}))},computeSize:e=>e>=1024?e>=1048576?(e/1024/1024).toFixed(2)+"M":(e/1024).toFixed(2)+"KB":e+"B",handleDownLoadFile(e){const o=this.baseUrl+`/message/downLoadFile?path=${encodeURIComponent(e.fileData.filepath)}&name=${encodeURIComponent(e.fileData.originalFilename)}`;this.onItemId=e.id;S({url:o,success:o=>{this.onItemId="";const s=document.createElement("a");s.href=o.tempFilePath,s.download=e.fileData.originalFilename,s.click()}}).onProgressUpdate((o=>{this.downLoadProcess=o.totalBytesWritten/e.fileData.size*100}))}}},[["render",function(e,n,l,i,p,m){const _=c(d("uni-icons"),V),y=a,g=F,b=C,w=c(d("uni-easyinput"),P);return o(),f("div",{class:"content"},[k("div",{ref:"scrollView",style:{flex:"1","overflow-y":"scroll"}},[(o(!0),f(h,null,v(p.messageList,(e=>(o(),f("div",{class:"item-container",key:e.id},[k("div",{class:"time"},I(e.dateTime),1),k("div",{class:"item-content"},["text"==e.type?(o(),f("div",{key:0},I(e.content),1)):"file"==e.type?(o(),f("div",{key:1,style:{display:"flex","align-items":"center","justify-content":"space-between"}},[k("div",{style:{"background-color":"white",padding:"10px",width:"40%"}},[k("div",null,[u(_,{type:"paperclip"}),u(y,{style:{color:"black"}},{default:t((()=>[$(I(e.fileData.originalFilename),1)])),_:2},1024)]),k("div",null,[p.onItemId==e.id?(o(),s(g,{key:0,percent:p.downLoadProcess,"stroke-width":"3"},null,8,["percent"])):r("",!0)])]),k("span",null,I(m.computeSize(e.fileData.size)),1),k("div",null,[u(b,{type:"primary",size:"mini",onClick:o=>m.handleDownLoadFile(e)},{default:t((()=>[$("下载")])),_:2},1032,["onClick"])])])):r("",!0)])])))),128))],512),k("div",{style:{display:"flex","align-items":"end",gap:"10px",padding:"20px"}},[u(w,{type:"textarea",modelValue:p.contentValue,"onUpdate:modelValue":n[0]||(n[0]=e=>p.contentValue=e),maxlength:-1,placeholder:"请输入内容"},null,8,["modelValue"]),k("div",null,[k("div",null,[u(b,{size:"mini",onClick:m.handleFileSend},{default:t((()=>[$("传文件")])),_:1},8,["onClick"])]),u(b,{type:"primary",size:"mini",loading:p.loading,onClick:n[1]||(n[1]=e=>m.handleSend()),style:{width:"100%"}},{default:t((()=>[$("发送")])),_:1},8,["loading"])])])])}],["__scopeId","data-v-68eb6e9a"]]);export{M as default};
